servers:
- name: z820
  #providerUri: "qemu+ssh://k8s@10.10.40.143:1234/system?keyfile=private_key_location"
  connection:
    type: remote
    user: dinmusic
    ip: 10.10.40.143
    ssh:
      port: 1234
      keyfile: "~/.ssh/id_rsa_z820"
  resourcePoolPath: "/var/lib/libvirt/pools/"
- name: ml350
  connection:
    type: remote
    user: dinmusic
    ip: 10.10.40.144
    ssh:
      port: 22 # default
      keyfile: "~/.ssh/id_rsa_ml350"
  resourcePoolPath: "/var/lib/libvirt/pools/"

cluster:
  name: "my-k8s-cluster"
  network:
    mode: "bridge" # [bridge, NAT, route]
    cidr: "10.10.64.0/24"
    gateway: "10.10.64.1"
    bridge: "br0"
    dns:
    - 1.1.1.1
    - 1.0.0.1
  nodeTemplate: # Applies to all nodes
    networkInterface: "ens3"
    user: "k8s"
    ssh:
      privateKeyPath: "~/.ssh/id_rsa_test"
      addToKnownHosts: true
    image:
      distro: "ubuntu"
      source: "https://cloud-images.ubuntu.com/focal/current/focal-server-cloudimg-amd64-disk-kvm.img"
    updateOnBoot: true
  nodes:
    loadBalancer:
      vip: "10.10.64.200" # Virtual IP shared between load balancers - floating IP
      default: # For all VMs
        ram: 4 # GiB
        cpu: 1 # vCPU
        storage: 16 # GiB
      instances:
      - id: 1
        ip: "10.10.64.5"         # If omitted DHCP lease is requested
        mac: "52:54:00:00:00:40" # If omitted MAC address is generated
        ram: 8                   # Overrides default RAM value for this node
        cpu: 8                   # Overrides default CPU value for this node
        server: z820             # If ommited first server from the list is taken
      - id: 2
        ip: "192.168.113.6"
        mac: "52:54:00:00:00:41"
        server: ml350
      - id: 3
        ip: "192.168.113.7"
        mac: "52:54:00:00:00:42"
    master:
      default:
        ram: 8
        cpu: 2
        storage: 256
      instances:
      - id: 1 # Node with generated MAC, DHCP lease and default RAM and CPU
        server: z820
      - id: 2
        server: z820
      - id: 3
        server: ml350
    worker:
      default:
        ram: 16
        cpu: 4
        label: "node"
      instances:
      - id: 1
        ip: "10.10.64.101"
        cpu: 8
        ram: 64
        label: "compute"
        server: z820
      - id: 2
        ip: "10.10.64.102"
      - id: 3
        ip: "10.10.64.103"
        ram: 64
        label: "mem"
      - id: 4
        server: ml350
      - id: 5
        server: ml350

kubernetes:
  version: "v1.21.6"
  networkPlugin: "calico"
  dnsMode: "coredns"
  copyKubeconfig: false  
  kubespray:
    url: "https://github.com/kubernetes-sigs/kubespray.git"
    version: "v2.17.1"
    addons:
      enabled: true
      configPath: "sample/addons.yaml"
  other:
    copyKubeconfig: false
